<!DOCTYPE html>
<html ng-app="relocate">
  <head>
    <title>Make a Move</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700,300' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/css/default.css">
  </head> 
  <body>
    <div ng-controller="mainController as main">
      <header id="la-img" alt="Image of Los Angeles.">
        <div class="pattern">
          <h1 class="container" id="logo">Make a Move</h1>
          <h2 class="container" id="hook">Search for jobs and apartments</h2>
          <a href="#scroll"><img class="arrow" src="images/scroll.png"></a>
        </div>
        <div class="row">
          <form class="col-sm-12 input-group" ng-submit="main.fetch()">
            <input class="input col-sm-12 col-md-4 form-control" type="text" ng-model="keyword" placeholder="Keyword Job Search">
            <input class="input col-sm-12 col-md-4 form-control" type="text" ng-model="location" placeholder="Location: City, Zip Code">
            <input class="input col-sm-12 col-md-4 form-control btn btn-default" type="submit" value="Search">
          </form>
        </div>
      </header>
    <!-- search input for yelp and indeed search -->
      <div class="row" id="scroll">
        <div class="col-sm-1"></div>
        <!-- indeed job list -->
        <div class="col-sm-5">
          <h3 class="title">Indeed Job Results</h3>
          <ul class="indeed-results list-group">
            <li class="list-group-item" ng-repeat="result in main.results">
              <p>
                <strong>{{ result.company }}</strong>
                <br><em>{{ result.jobtitle }}</em>. 
                <br>Located in {{ result.city }}.
                <br><span id="snippet">{{ result.snippet | removeBtagFilter }}.<span> 
                <br>Click <a target="_blank" href={{ result.url }}>here</a> to view the indeed posting.
              </p>
            </li>
          </ul>
        </div>
        <!-- yelp apartment list -->
        <div class="col-sm-5">
          <h3 class="title">Yelp Apartment Results</h3>
          <ul class="yelp-results list-group">
            <li class="list-group-item" ng-repeat="business in main.businesses">
              <button class="list-group-item" type="button" class="apartment" ng-click="showDetails = ! showDetails">
                <strong>{{ business.name }}</strong> is located in {{ business.location.city }}.
                <br> Rating: {{ business.rating }} stars 
                <br> Review count: {{ business.review_count }}
                <br> Click to view more information.
              </button>
              <div class="list-group-item show" ng-show="showDetails">
                <img src={{ business.image_url }}>
                <img id="rating" src={{ business.rating_img_url }}>
                <p id="review">
                  <br>Call {{ business.display_phone }} for pricing.
                  <br>User review: {{ business.snippet_text }}.
                  <br>Click <a target="_blank" href={{ business.mobile_url }}>here</a> to view their yelp page.
                  <br>
                </p>
                <p>The walkscore for this apartment is: <strong>{{ business.walkScore.walkscore }} - {{ business.walkScore.description }}</strong>
                </p>
              </div>
            </li>
          </ul>
        </div>
        <div class="col-sm-1"></div>
      </div>
      <!-- map -->
      <div class="mapBox">
        <ng-map id="map" zoom="0" scrollwheel="false" default-style="false" center="[{{ main.businesses[0].location.coordinate.latitude }}, {{ main.businesses[0].location.coordinate.longitude }}]" zoom-to-include-markers="auto">
          <!-- yelp marker -->
          <marker ng-repeat="business in main.businesses" position="{{ business.location.coordinate.latitude }}, {{ business.location.coordinate.longitude }}" title="{{ business.name }}" on-click="showYelpInfoWindow({ lat: business.location.coordinate.latitude, lng: business.location.coordinate.longitude, apartment: business.name })">
          </marker>
          <!-- indeed custom marker -->
          <marker ng-repeat="result in main.results" position="{{ result.latitude }}, {{ result.longitude }}" icon="images/blue-marker.png" title="{{ result.company }}" on-click="showIndeedInfoWindow({ lat: result.latitude, lng: result.longitude, company: result.company })">
          </marker>
          <directions
            draggable="true"
            travel-mode="DRIVING"
            panel="panel"
            origin="{{ main.businesses[0].location.coordinate.latitude }}, {{ main.businesses[0].location.coordinate.longitude }}"
            destination="{{ main.results[5].latitude }}, {{ main.results[5].longitude }}">
          </directions>
        </ng-map>
        <h3>Directions:</h3>
        <div id="panel" style="width: 100%; height:450px"></div>
      </div>
    </div>
   
    <!-- jQuery, Bootstrap, Map, and my JS -->
    <script src="//code.jquery.com/jquery-1.12.0.min.js"></script>
    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src="vendor.js"></script>
    <script src="all.js"></script>
    <script src="/bower_components/ngmap/build/scripts/ng-map.min.js"></script>
    <script src="http://maps.google.com/maps/api/js"></script> 
  </body>
</html>